-- DDL for POSTULANTE. 
create table POSTULANTE (
    RUN_POSTULANTE     NUMBER(9)    NOT NULL,
    DV_RUN             VARCHAR2(1)  NOT NULL,
    IMAGEN_POSTULANTE  BLOB         NOT NULL,    
    PRIMER_NOMBRE      VARCHAR2(45) NOT NULL,
    SEGUNDO_NOMBRE     VARCHAR2(45) NULL,
    PRIMER_APELLIDO    VARCHAR2(50) NOT NULL,
    SEGUNDO_APELLIDO   VARCHAR2(50) NOT NULL,
    FECHA_NACIMIENTO   DATE         NOT NULL,
    TELEFONO_TRABAJO   NUMBER(9)    NULL,
    TELEFONO_MOVIL     NUMBER(9)    NULL,
    EMAIL              VARCHAR2(45) NOT NULL,
    ID_ESTADO_CIVIL    NUMBER(3)    NOT NULL,
    ID_COMUNA          NUMBER(3)    NOT NULL,
    ID_PROVINCIA       NUMBER(3)    NOT NULL,
    ID_REGION          NUMBER(3)    NOT NULL,
    ID_ACREDITACION    NUMBER(3)    NOT NULL,
    NRO_DOMICILIO      NUMBER(6)    NOT NULL,
    ID_NIVEL_ED        NUMBER(3)    NOT NULL
);

ALTER TABLE POSTULANTE
ADD CONSTRAINT PK_POSTULANTE
PRIMARY KEY(RUN_POSTULANTE);
-- END DDL for POSTULANTE

--DDL for COMUNA
CREATE TABLE COMUNA (
    ID_COMUNA          NUMBER(3)    NOT NULL,
    NOMBRE_COMUNA      VARCHAR2(50) NOT NULL,
    ID_PROVINCIA       NUMBER(3)    NOT NULL
);

ALTER TABLE COMUNA
ADD CONSTRAINT PK_COMUNA
PRIMARY KEY(ID_COMUNA);

ALTER TABLE POSTULANTE
ADD CONSTRAINT FK_COMUNA_POSTULANTE
FOREIGN KEY(ID_COMUNA)
REFERENCES COMUNA(ID_COMUNA);
--END DDL for COMUNA

--DDL for PROVINCIA
CREATE TABLE PROVINCIA (
    ID_PROVINCIA      NUMBER(3)     NOT NULL, 
    NOMBRE_PROVINCIA  VARCHAR2(50)  NOT NULL,
    ID_REGION         NUMBER(3)     NOT NULL
);

ALTER TABLE PROVINCIA
ADD CONSTRAINT PK_PROVINCIA
PRIMARY KEY(ID_PROVINCIA);

ALTER TABLE COMUNA
ADD CONSTRAINT FK_PROVINCIA_COMUNA
FOREIGN KEY(ID_PROVINCIA)
REFERENCES PROVINCIA(ID_PROVINCIA);
--END DDL for PROVINCIA.

--DDL for REGION
CREATE TABLE REGION (
    ID_REGION        NUMBER(3) NOT NULL,
    NOMBRE_REGION    VARCHAR2(50) NOT NULL
);

ALTER TABLE REGION
ADD CONSTRAINT PK_REGION
PRIMARY KEY(ID_REGION);

ALTER TABLE PROVINCIA
ADD CONSTRAINT FK_PROVINCIA_REGION
FOREIGN KEY(ID_PROVINCIA)
REFERENCES REGION(ID_REGION);
--END DDL for REGION.


-- ADD REFERENCES TO PROVINCIA AND REGION
ALTER TABLE POSTULANTE
ADD CONSTRAINT FK_PROVINCIA_POSTULANTE
FOREIGN KEY(ID_PROVINCIA)
REFERENCES PROVINCIA(ID_PROVINCIA);

ALTER TABLE POSTULANTE
ADD CONSTRAINT FK_REGION_POSTULANTE
FOREIGN KEY(ID_REGION)
REFERENCES REGION(ID_REGION);
-- END ADD REFERENCES TO PROVINCIA AND REGION.

-- DDL for CARGA_FAMILIAR
create table CARGA_FAMILIAR (
    RUN_CARGA          NUMBER(9)     NOT NULL,
    DV_RUN             VARCHAR2(1)   NOT NULL,
    PRIMER_NOMBRE      VARCHAR2(45)  NOT NULL,
    SEGUNDO_NOMBRE     VARCHAR2(45)  NULL,
    PRIMER_APELLIDO    VARCHAR2(50)  NOT NULL,
    SEGUNDO_APELLIDO   VARCHAR2(50)  NOT NULL,
    RUN_POSTULANTE     NUMBER(9)     NOT NULL
);

ALTER TABLE CARGA_FAMILIAR
ADD CONSTRAINT PK_CARGA_FAMILIAR
PRIMARY KEY(RUN_CARGA);

ALTER TABLE CARGA_FAMILIAR
ADD CONSTRAINT FK_POSTULANTE_CARGA
FOREIGN KEY(RUN_POSTULANTE)
REFERENCES POSTULANTE(RUN_POSTULANTE);
-- end DDL for CARGA_FAMILIAR

-- DDL for CONVIVIENTE_CIVIL
create table CONVIVIENTE_CIVIL (
    RUN_CONVIVIENTE    NUMBER(9)     NOT NULL,
    DV_RUN             VARCHAR2(1)   NOT NULL,
    PRIMER_NOMBRE      VARCHAR2(45)  NOT NULL,
    SEGUNDO_NOMBRE     VARCHAR2(45)  NULL,
    PRIMER_APELLIDO    VARCHAR2(50)  NOT NULL,
    SEGUNDO_APELLIDO   VARCHAR2(50)  NOT NULL,
    RUN_POSTULANTE     NUMBER(9)     NOT NULL
);

ALTER TABLE CONVIVIENTE_CIVIL
ADD CONSTRAINT PK_CONVIVIENTE_CIVIL
PRIMARY KEY(RUN_CONVIVIENTE);

ALTER TABLE CONVIVIENTE_CIVIL
ADD CONSTRAINT FK_POSTULANTE_CONVIVIENTE
FOREIGN KEY(RUN_POSTULANTE)
REFERENCES POSTULANTE(RUN_POSTULANTE);
-- END DDL for CONVIVIENTE_CIVIL.

--DDL for CUENTA_AHORRO
CREATE TABLE CUENTA_AHORRO (
    ID_CUENTA         NUMBER(6)    NOT NULL,
    FECHA_APERTURA    DATE         NOT NULL,
    MONTO_AHORRADO    NUMBER(10)   NOT NULL,
    ID_TIPO_CUENTA    NUMBER(3)    NOT NULL,
    ID_SUCURSAL      NUMBER(3)    NOT NULL,
    ID_ENTIDAD_FINANC NUMBER(3)    NOT NULL,
    RUN_POSTULANTE     NUMBER(9)    NOT NULL
);

ALTER TABLE CUENTA_AHORRO
ADD CONSTRAINT PK_CUENTA_AHORRO
PRIMARY KEY(ID_CUENTA);
--END DDL for CUENTA_AHORRO




--DDL for TIPO_CUENTA
CREATE TABLE TIPO_CUENTA (
    ID_TIPO_CUENTA    NUMBER(3)    NOT NULL,
    DESCRIPCION       VARCHAR(40)  NOT NULL
);

ALTER TABLE TIPO_CUENTA
ADD CONSTRAINT PK_TIPO_CUENTA
PRIMARY KEY(ID_TIPO_CUENTA);

ALTER TABLE CUENTA_AHORRO
ADD CONSTRAINT FK_TIPO_CUENTA_AHORRO
FOREIGN KEY(ID_TIPO_CUENTA)
REFERENCES TIPO_CUENTA(ID_TIPO_CUENTA);
-- END DDL for TIPO_CUENTA

-- DDL for ENTIDAD_FINANCIERA
CREATE TABLE ENTIDAD_FINANCIERA (
    ID_ENTIDAD_FINANC NUMBER(3)    NOT NULL,
    DESCRIPCION       VARCHAR(40)  NOT NULL
);

ALTER TABLE ENTIDAD_FINANCIERA
ADD CONSTRAINT PK_ENTIDAD_FINANCIERA
PRIMARY KEY(ID_ENTIDAD_FINANC);

ALTER TABLE CUENTA_AHORRO
ADD CONSTRAINT FK_ENTIDAD_CUENTA_AHORRO
FOREIGN KEY(ID_ENTIDAD_FINANC)
REFERENCES ENTIDAD_FINANCIERA(ID_ENTIDAD_FINANC);

ALTER TABLE CUENTA_AHORRO
ADD CONSTRAINT FK_POSTULANTE_CUENTA 
FOREIGN KEY(RUN_POSTULANTE)
REFERENCES POSTULANTE(RUN_POSTULANTE);

-- END DDL for ENTIDAD_FINANCIERA
-- END DDL IDENTIFICACION DEL POSTULANTE 

-- DDL for ACREDITACIONES
-- DDL for ACREDITACION_INDIGENA

CREATE TABLE ACREDITACION_INDIGENA (
    ID_ACREDITACION   NUMBER(3)    NOT NULL,
    DESCRIPCION       VARCHAR2(45) NOT NULL
);

ALTER TABLE ACREDITACION_INDIGENA 
ADD CONSTRAINT PK_ACREDITACION
PRIMARY KEY(ID_ACREDITACION);

ALTER TABLE POSTULANTE
ADD CONSTRAINT FK_ACREDITACION_POSTULANTE
FOREIGN KEY(ID_ACREDITACION)
REFERENCES ACREDITACION_INDIGENA(ID_ACREDITACION);
-- END for ACREDITACION_INDIGENA
-- END DDL for ACREDITACIONES

CREATE TABLE DOMICILIO (
    NRO_DOMICILIO     NUMBER(6)    NOT NULL,
    ID_COMUNA         NUMBER(3)    NOT NULL,
    PRIMARY KEY(NRO_DOMICILIO)
);

ALTER TABLE POSTULANTE
ADD CONSTRAINT FK_DOMICILIO_POSTULANTE
FOREIGN KEY(NRO_DOMICILIO)
REFERENCES DOMICILIO(NRO_DOMICILIO);

-- DDL for TRAMOS

CREATE TABLE TRAMO_EDAD (
    ID_TRAMO_EDAD     NUMBER(3)   NOT NULL,
    TRAMO_INF         NUMBER(3)   NOT NULL,
    TRAMO_SUP         NUMBER(3)   NOT NULL,
    PUNTAJE           NUMBER(5)   NOT NULL,
    PRIMARY KEY(ID_TRAMO_EDAD)
);



CREATE TABLE TRAMO_CARGAS (
    ID_TRAMO_CARGAS   NUMBER(3)   NOT NULL,
    TRAMO_INF         NUMBER(3)   NOT NULL,
    TRAMO_SUP         NUMBER(3)   NOT NULL,
    PUNTAJE           NUMBER(10)   NOT NULL,
    PRIMARY KEY(ID_TRAMO_CARGAS)
);

CREATE TABLE TRAMO_MONTO_AHORRADO (
    ID_TRAMO_AHORRO     NUMBER(3)   NOT NULL,
    TRAMO_INF           NUMBER(10)  NOT NULL,
    TRAMO_SUP           NUMBER(10)  NOT NULL,
    PUNTAJE             NUMBER(10)  NOT NULL,
    PRIMARY KEY(ID_TRAMO_AHORRO)
);

CREATE TABLE ESTADO_CIVIL (
    ID_ESTADO_CIVIL     NUMBER(3)   NOT NULL,
    DESCRIPCION         VARCHAR(25) NOT NULL,
    PUNTAJE             NUMBER(10)   NOT NULL
);

ALTER TABLE ESTADO_CIVIL 
ADD CONSTRAINT PK_ESTADO_CIVIL
PRIMARY KEY(ID_ESTADO_CIVIL);

ALTER TABLE POSTULANTE
ADD CONSTRAINT FK_ESTADO_CIV_POST 
FOREIGN KEY(ID_ESTADO_CIVIL)
REFERENCES ESTADO_CIVIL(ID_ESTADO_CIVIL);

CREATE TABLE NIVEL_EDUCACIONAL (
    ID_NIVEL_ED         NUMBER(3)    NOT NULL,
    DESCRIPCION         VARCHAR2(25) NOT NULL,
    PUNTAJE             NUMBER(3)    NOT NULL,
    PRIMARY KEY(ID_NIVEL_ED)
);

ALTER TABLE POSTULANTE
ADD CONSTRAINT FK_NIVEL_ED_POST
FOREIGN KEY(ID_NIVEL_ED)
REFERENCES NIVEL_EDUCACIONAL(ID_NIVEL_ED);


CREATE TABLE DETALLE_DEPOSITO (
    ID_DETALLE          NUMBER(3)    NOT NULL,
    MONTO               NUMBER(9)    NOT NULL,
    FECHA_DEPOSITO      DATE         NOT NULL,
    RUN_POSTULANTE      NUMBER(9)    NOT NULL,
    ID_SUCURSAL         NUMBER(3)    NOT NULL,
    ID_CUENTA           NUMBER(6)      NOT NULL
);

ALTER TABLE DETALLE_DEPOSITO 
ADD CONSTRAINT PK_DETALLE_DEPOSITO 
PRIMARY KEY(ID_DETALLE);

ALTER TABLE DETALLE_DEPOSITO 
ADD CONSTRAINT FK_DETALLE_POSTULANTE
FOREIGN KEY(RUN_POSTULANTE)
REFERENCES POSTULANTE(RUN_POSTULANTE);

ALTER TABLE DETALLE_DEPOSITO
ADD CONSTRAINT FK_DETALLE_CUENTA
FOREIGN KEY(ID_CUENTA)
REFERENCES CUENTA_AHORRO(ID_CUENTA);

CREATE TABLE SUCURSAL (
    ID_SUCURSAL      NUMBER(3)    NOT NULL,
    NOMBRE_SUCURSAL  VARCHAR2(45) NOT NULL,
    ID_ENTIDAD_FINANC NUMBER(3)   NOT NULL
);

ALTER TABLE SUCURSAL
ADD CONSTRAINT PK_SUCURSAL
PRIMARY KEY(ID_SUCURSAL);

ALTER TABLE SUCURSAL
ADD CONSTRAINT FK_SUCURSAL_ENTIDAD
FOREIGN KEY(ID_ENTIDAD_FINANC)
REFERENCES ENTIDAD_FINANCIERA(ID_ENTIDAD_FINANC);

ALTER TABLE CUENTA_AHORRO
ADD CONSTRAINT FK_CUENTA_SUCURSAL
FOREIGN KEY(ID_SUCURSAL)
REFERENCES SUCURSAL(ID_SUCURSAL);

commit;
/*
CREATE TABLE VIVIENDA (
    ID_VIVIENDA      NUMBER(3) NOT NULL,
    USADA            BOOLEAN   NOT NULL,
    VALOR_VIVIENDA   NUMBER(9) NOT NULL,
    ID_TIPO_VIVIENDA NUMBER(3) NOT NULL,
    RUN_PROPIETARIO
);
*/

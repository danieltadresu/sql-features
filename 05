-- Va saliendo...

select * from asesoria;

declare
    cursor cc is ( 
                    select 
                        a.rutprof,
                        count(a.rutprof),
                        sum(s.incentivo_sector)
                    from asesoria a
                    join empresa e 
                    on a.idempresa = e.idempresa
                    join sector s
                    on e.codsector = s.codsector
                    where extract(month from sysdate)-1 = extract(month from a.inicio)
                    group by a.rutprof;
                 );
begin
    
end;

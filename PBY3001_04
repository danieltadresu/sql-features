-- REQUERIMIENTOS GENERALES
-- 1.1 CONSTRUIR MER
-- 1.2 CONSTRUIR PROCESO DE ASINGACIÓN DE PUNTAJES A LOS POSTULANTES DEL SUBSIDIO
--     EL QUE SERÁ EJECUTADO DESDE LA APLICACIÓN QUE SE CONSTRUYA.
-- 1.3 CONSTRUIR VISTA QUE MUESTRE A LOS POSTULANTES QUE FUERON BENEFICIADOS.
-- 1.4 CONSTURIR LA CNSULTA DE LA INFORMACIÓN DE LOS POSTULANTES AL SUBSIDIO 


--1.2

--PUNTAJE POR EDAD.
select
p.run_postulante as run_postulante,
extract(year from sysdate) - extract(year from p.fecha_nacimiento)  as edad,
ptj_edad.puntaje
from postulante p
join puntaje_edad ptj_edad
on extract(year from sysdate) - extract(year from p.fecha_nacimiento) between ptj_edad.tramo_inf and ptj_edad.tramo_sup;

--TOTAL CARGAS FAMILIARES
select
p.run_postulante,
count(c.run_carga)
from postulante p
join carga_familiar c
on p.run_postulante = c.run_postulante
group by p.run_postulante;

--PUNTJE ESTADO CIVIL.

select
p.run_postulante,
estc.descripcion,
estc.puntaje_est_civil
from postulante p
join estado_civil estc
on p.id_estado_civil = estc.id_estado_civil;

-- * PUNTAJE PUEBLO INDIGENA

-- PUNTAJE_MONTO_AHORRO
select
p.run_postulante,
c.id_cuenta,
c.monto_ahorrado,
ptje.puntaje
from POSTULANTE p
join CUENTA_AHORRO c
on p.run_postulante = c.run_postulante
join PUNTAJE_MONTO_AHORRO ptje
on c.monto_ahorrado between ptje.tramo_inf and ptje.tramo_sup;

select 
p.run_postulante,
pfs.nombre_profesion,
nvled.id_nivel_ed,
nvled.descripcion,
nvled.puntaje
from POSTULANTE p
join PROFESION pfs 
on p.id_profesion = pfs.id_profesion
join NIVEL_EDUCACIONAL nvled
on pfs.id_nivel_ed = nvled.id_nivel_ed;
